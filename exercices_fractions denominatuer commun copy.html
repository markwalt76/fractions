<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Exercices : Additions et Soustractions de Fractions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; padding: 10px; font-size: 14px; line-height: 1.6; }
    h1 { text-align: center; margin-bottom: 10px; font-size: 18px; }
    .exo { margin: 4px 0; padding: 4px; border: none; border-radius: 0; width: 100%; }
    .fraction { display: inline-block; text-align: center; margin: 0 5px; vertical-align: middle; }
    .fraction span { display: block; font-size: 16px; line-height: 1.4; }
    .fraction .den { border-top: 1px solid #000; }
    button { margin-top: 10px; padding: 6px 12px; font-size: 12px; }
    @page { size: A4 portrait; margin: 10mm; }
    @media print {
      button { display: none; }
      .exo { page-break-inside: avoid; border: none; }
      body { padding: 0; font-size: 11px; }
    }
    #container { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); column-gap: 10px; row-gap: 10px; }
    .op  { display: inline-block; font-weight: normal; font-size: 16px; position: relative; top: -2px; margin: 0 4px; }
    .cmp { display:inline-block; font-weight:bold; font-size:16px; margin:0 4px; position:relative; top:-2px; }
  </style>
</head>
<body>
  <h1>Exercices : Fractions (Dénominateur Commun)</h1>
  <div style="margin-bottom:8px; font-size:12px;">
    <label style="margin-right:10px;"><input type="radio" name="type_exo" value="mix" checked> Mélange (70% opérations / 30% comparaisons)</label>
    <label style="margin-right:10px;"><input type="radio" name="type_exo" value="op"> Opérations seulement</label>
    <label><input type="radio" name="type_exo" value="cmp"> Comparaisons seulement</label>
  </div>
  <div id="container"></div>
  <button onclick="genererExercices()">Générer de nouveaux exercices</button>
  <button onclick="window.print()">Exporter en PDF</button>

  <script>
    function frac(n, d) {
      return `<div class='fraction'><span>${n}</span><span class='den'>${d}</span></div>`;
    }

    // Génère un mélange aléatoire d'opérations et de comparaisons
    function genererExercices() {
      const cont = document.getElementById('container');
      cont.innerHTML = '';

      const radios = document.querySelector('input[name="type_exo"]:checked');
      const mode = radios ? radios.value : 'mix';

      for (let i = 0; i < 40; i++) {
        let type;
        if (mode === 'op') {
          type = 'op';
        } else if (mode === 'cmp') {
          type = 'cmp';
        } else {
          type = Math.random() < 0.7 ? 'op' : 'cmp'; // 70% / 30%
        }

        // dénominateur de base
        let denom;
        if (Math.random() < 0.4) {
          denom = Math.floor(Math.random() * 11) + 2;  // 2 à 12
        } else {
          denom = Math.floor(Math.random() * 900) + 10; // 10 à 909
        }

        const a = Math.floor(Math.random() * denom) + 1;
        const b = Math.floor(Math.random() * denom) + 1;

        const exo = document.createElement('div');
        exo.className = 'exo';

        if (type === 'op') {
          // ——— ADDITIONS / SOUSTRACTIONS ———
          const op = Math.random() > 0.5 ? '+' : '-';
          exo.innerHTML =
            `${frac(a, denom)} <span class='op'>${op}</span> ${frac(b, denom)} = ` +
            `<span style='position:relative; top:-4px;'>____</span>`;
        } else {
          // ——— COMPARAISONS ———
          // choisir type de comparaison : soit numérateur identique, soit dénominateur identique
          const modeCmp = Math.random() < 0.5 ? 'sameNum' : 'sameDen';

          let denom2;
          let num2;

          if (modeCmp === 'sameNum') {
            // numérateur identique, dénominateurs différents
            denom2 = Math.random() < 0.4
              ? (Math.floor(Math.random() * 11) + 2)
              : (Math.floor(Math.random() * 900) + 10);
            num2 = a;
          } else {
            // dénominateur identique, numérateurs différents
            denom2 = denom;
            num2 = Math.floor(Math.random() * denom) + 1;
          }

          exo.innerHTML =
            `${frac(a, denom)} <span class="cmp">...</span> ${frac(num2, denom2)}`;
        }

        cont.appendChild(exo);
      }
    }

    // Génération initiale
    genererExercices();
  </script>
</body>
</html>
